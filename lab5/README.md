## Отчёт о нагрузочном тестировании: сравнение производительности с кешированием Redis и без него

**Цель работы:** оценить влияние кеша Redis на время отклика и пропускную способность сервиса управления бюджетом, работающего на FastAPI + PostgreSQL + MongoDB. Для нагрузки использовался `wrk` со скриптом `get.lua`, имитирующим чтение сводной финансовой информации пользователей (данные – см. список `USERS_DATA`, `INCOMES_DATA`, `EXPENSES_DATA`).

### Конфигурации

| Режим        | Переменная `REDIS_URL` | Контейнер `redis` |
| ------------ | ---------------------- | ----------------- |
| **Без кеша** | пустая                 | отключён          |
| **С кешом**  | `redis://redis:6379/0` | включён           |


### Результаты тестов `wrk` (20 с прогон)

#### 1. Без кеша

| Параметры                   | Средняя задержка | Запросов/сек    | Передача   |
| --------------------------- | ---------------- | --------------- | ---------- |
| 1 поток / 10 соединений     | **44.3 ms**      | **212.8 req/s** | 31.9 KB/s  |
| 5 потоков / 50 соединений   | **71.5 ms**      | **138.4 req/s** | 103.6 KB/s |
| 10 потоков / 100 соединений | **159.2 ms**     | **66.2 req/s**  | 97.4 KB/s  |

#### 2. С кешом Redis

| Параметры                   | Средняя задержка | Запросов/сек    | Передача   |
| --------------------------- | ---------------- | --------------- | ---------- |
| 1 поток / 10 соединений     | **50.7 ms**      | **205.6 req/s** | 29.8 KB/s  |
| 5 потоков / 50 соединений   | **60.1 ms**      | **164.3 req/s** | 122.7 KB/s |
| 10 потоков / 100 соединений | **128.9 ms**     | **87.5 req/s**  | 125.4 KB/s |

### Анализ

* **Низкая нагрузка (1 × 10).**
  Кеш даёт небольшой «штраф»: дополнительные 6 мс на инициализацию клиента Redis → скорость падает \~3 %.

* **Средняя нагрузка (5 × 50).**
  Кеширование выигрывает: задержка снижается на 11 ms, RPS растёт на 19 %. Большая доля запросов обслуживается, минуя PostgreSQL + Mongo.

* **Высокая нагрузка (10 × 100).**
  Использование Redis заметно улучшает throughput: +32 % RPS при ‑30 ms к среднему отклику. База данных перестаёт быть узким местом, а сетевые RTT Redis малы.

### Выводы

1. **Redis полезен при росте параллелизма.** При 50–100 одновременных соединениях кеширование повышает пропускную способность до 32 % и уменьшает задержки до 30 ms.
2. **Для одиночных запросов выигрыш незаметен**; инициализация клиента Redis нивелирует экономию на чтении.
3. **Рекомендуемое включение кеша** – в режимах продакшн/нагрузки с 5+ потоками или при характерном количестве запросов > 100 req/s.
